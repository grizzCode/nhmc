function WDIInstagram(e){this.user={},this.access_tokens=[],this.filters=[],void 0!==e&&(void 0!==e.access_tokens&&(this.access_tokens=e.access_tokens),void 0!==e.filters&&(this.filters=e.filters));var w=this;function g(){return void 0!==w.user&&void 0!==w.user.user_name?w.user.user_name:"undefined"!=typeof wdi_object&&void 0!==wdi_object.user?wdi_object.user.user_name:""}function u(){return void 0!==w.user&&void 0!==w.user.access_token?w.user.access_token:"undefined"!=typeof wdi_object&&void 0!==wdi_object.user&&void 0!==wdi_object.user.access_token?wdi_object.user.access_token:""}this.statusCode={429:function(){console.log(" 429: Too many requests. Try after one hour")}},this.getFilter=function(e){var t=w.filters;if(void 0===t)return!1;for(var s=0;s<t.length;s++)if(t[s].where==e)if("object"==typeof t[s].what&&2==t[s].what.length){if(void 0!==window[t[s].what[0]]&&"function"==typeof window[t[s].what[0]][t[s].what[1]])return window[t[s].what[0]][t[s].what[1]]}else{if("string"!=typeof t[s].what)return"function"==typeof t[s].what&&t[s].what;if("function"==typeof window[t[s].what])return window[t[s].what]}return!1},this.addToken=function(e){"string"==typeof e&&w.access_tokens.push(e)},this.resetTokens=function(){w.access_tokens=[]};var l=0,p={data:new Array,paging:{}};this.getTagRecentMedia=function(i,n,c,a,u){u=void 0===u||"number"!=typeof u?0:u;var t=!1,e=this.statusCode,s=!1;this.getFilter("getTagRecentMedia");a=0===parseInt(a)?"top_media":"recent_media",void 0===n||0===n.length||("success"in n&&(t=!0),"statusCode"in n&&(e=n.statusCode),"error"in n&&(s=!0),"args"in n||(n.args={}),"count"in n?(n.count=parseInt(n.count),(!Number.isInteger(n.count)||n.count<=0)&&(n.count=33)):n.count=33);var d=this.getTagId(i);function f(e){void 0===e.data&&(e.data=[]),t&&("object"==typeof n.success&&2==n.success.length?void 0!==window[n.success[0]]&&"function"==typeof window[n.success[0]][n.success[1]]&&window[n.success[0]][n.success[1]](e):"string"==typeof n.success?"function"==typeof window[n.success]&&window[n.success](e):"function"==typeof n.success&&n.success(e))}jQuery.ajax({type:"POST",url:wdi_ajax.ajax_url,dataType:"json",data:{iter:u,tagname:i,endpoint:a,wdi_nonce:wdi_ajax.wdi_nonce,wdiTagId:d,next_url:c,user_name:g(),action:"wdi_getTagRecentMedia",feed_id:wdi_ajax.feed_id},success:function(e){var t,s,o=!1,r="";void 0!==e.error&&(o=!0,r=e.error.type),void 0!==e.error&&"HashtagNotFound"===e.error.type?(l=5,f(e)):void 0!==e.error&&"OAuthException"!==e.error.type&&l<5?(l++,w.getTagRecentMedia(i,n,c,a,u)):void 0!==e.response&&void 0!==e.response.iter&&p.data.length<parseInt(wdi_ajax.number_of_photos)&&u<10&&void 0!==e.response.paging&&""!=e.response.paging.next?(c=e.response.paging.next,p.data=p.data.concat(e.response.data),p.paging=e.response.paging,w.getTagRecentMedia(i,n,c,a,e.response.iter)):(0!=p.data.length&&(e.response=p),!1===d&&(d=""),void 0!==e.tag_data&&(void 0!==(t=e.tag_data).tag_id&&(d=t.tag_id),s=[],void 0!==window.wdi_all_tags&&(s=window.wdi_all_tags),s[t.tag_id]=t,window.wdi_all_tags=s),e=e.response,(e=w.convertHashtagData(e)).meta={code:200,error:o,error_type:r},e.tag_id=d,f(e))},error:function(e){s&&("object"==typeof n.error&&2==n.error.length?"function"==typeof window[n.error[0]][n.error[1]]&&window[n.error[0]][n.error[1]](e):"string"==typeof n.error?"function"==typeof window[n.error]&&window[n.error](e):"function"==typeof n.error&&n.error(e))},statusCode:e})},this.getTagId=function(e){var t,s,o=[];for(s in"undefined"!=typeof wdi_controller?0!==(o=wdi_controller.feed_users).length||void 0!==(t=jQuery("#WDI_feed_users").val())&&""!==t&&(o=JSON.parse(t)):void 0!==window.wdi_all_tags&&(o=window.wdi_all_tags),o)if(e===o[s].username||"#"+e===o[s].username)return void 0!==o[s].tag_id&&o[s].tag_id;return!1},this.convertHashtagData=function(e){var t={data:[],pagination:{}};if(void 0!==e&&void 0!==e.paging&&(t.pagination={cursors:{after:e.paging.cursors.after},next_url:e.paging.next}),void 0!==e&&void 0!==e.data)for(var s in e.data){var o,r=e.data[s],i="IMAGE"===r.media_type?"image":"VIDEO"===r.media_type?"video":"carousel",n={id:r.id,user:{id:"",full_name:"",profile_picture:"",username:""},images:{thumbnail:{width:150,height:150,url:r.media_url},low_resolution:{width:320,height:320,url:r.media_url},standard_resolution:{width:1080,height:1080,url:r.media_url}},created_time:r.timestamp,caption:{id:"",text:r.caption,created_time:"",from:{id:"",full_name:"",profile_picture:"",username:""}},user_has_liked:0<r.like_count,likes:{count:r.like_count},tags:[],filter:"Normal",comments:{count:r.comments_count},type:i,link:r.permalink,location:null,attribution:null,users_in_photo:[]};if("IMAGE"===r.media_type||"CAROUSEL_ALBUM"===r.media_type?n.images={thumbnail:{width:150,height:150,url:r.media_url},low_resolution:{width:320,height:320,url:r.media_url},standard_resolution:{width:1080,height:1080,url:r.media_url}}:"VIDEO"===r.media_type&&(n.videos={standard_resolution:{width:640,height:800,url:r.media_url},low_bandwidth:{width:480,height:600,url:r.media_url},low_resolution:{width:480,height:600,url:r.media_url}}),"CAROUSEL_ALBUM"===r.media_type)for(var c in n.carousel_media=[],r.children.data)o="IMAGE"===r.children.data[c].media_type?{images:{thumbnail:{width:150,height:150,url:r.children.data[c].media_url},low_resolution:{width:320,height:320,url:r.children.data[c].media_url},standard_resolution:{width:640,height:640,url:r.children.data[c].media_url}},users_in_photo:[],type:"image"}:{videos:{standard_resolution:{width:640,height:800,url:r.children.data[c].media_url,id:r.children.data[c].id},low_bandwidth:{width:480,height:600,url:r.children.data[c].media_url,id:r.children.data[c].id},low_resolution:{width:480,height:600,url:r.children.data[c].media_url,id:r.children.data[c].id}},users_in_photo:[],type:"video"},n.carousel_media.push(o);t.data.push(n)}return t},this.searchForTagsByName=function(e,s){var o=this,r=!1,i=this.statusCode,n=!1;filter=this.getFilter("searchForTagsByName"),void 0===s||0===s.length||("success"in s&&(r=!0),"error"in s&&(n=!0),"statusCode"in s&&(i=s.statusCode));var c="https://api.instagram.com/v1/tags/search?q="+e+"&access_token="+u();w.getDataFromCache(function(e){function t(e){r&&("object"==typeof s.success&&2==s.success.length?void 0!==window[s.success[0]]&&"function"==typeof window[s.success[0]][s.success[1]]&&(filter&&(e=filter(e,o.filterArguments)),window[s.success[0]][s.success[1]](e)):"string"==typeof s.success?"function"==typeof window[s.success]&&(filter&&(e=filter(e,o.filterArguments)),window[s.success](e)):"function"==typeof s.success&&(filter&&(e=filter(e,o.filterArguments)),s.success(e)))}!1===e?jQuery.ajax({type:"POST",url:c,dataType:"jsonp",success:function(e){w.setDataToCache(c,e),t(e)},error:function(e){n&&("object"==typeof s.error&&2==s.error.length?"function"==typeof window[s.error[0]][s.error[1]]&&window[s.error[0]][s.error[1]](e):"string"==typeof s.error?"function"==typeof window[s.error]&&window[s.error](e):"function"==typeof s.error&&s.error(e))},statusCode:i}):t(e)},c)},this.searchForUsersByName=function(e,t){var s=this,o=!1,r=(this.statusCode,!1),i=this.getFilter("searchForUsersByName");void 0===t||0===t.length||("success"in t&&(o=!0),"error"in t&&(r=!0),"statusCode"in t&&t.statusCode),jQuery.ajax({type:"POST",dataType:"jsonp",url:"https://api.instagram.com/v1/users/search?q="+e+"&access_token="+u(),success:function(e){o&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(i&&(e=i(e,s.filterArguments)),e.args=t,window[t.success[0]][t.success[1]](e)):"string"==typeof t.success?"function"==typeof window[t.success]&&(i&&(e=i(e,s.filterArguments)),e.args=t,window[t.success](e)):"function"==typeof t.success&&(i&&(e=i(e,s.filterArguments)),(e.args=t).success(e)))},error:function(e){r&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:this.statusCode})},this.getRecentLikedMedia=function(t){var s=this,o=!1,e=this.statusCode,r=!1,i=this.getFilter("getRecentLikedMedia"),n="https://api.instagram.com/v1/users/self/media/liked?access_token="+u();void 0===t||0===t.length||("success"in t&&(o=!0),"error"in t&&(r=!0),"statusCode"in t&&(e=t.statusCode),"args"in t?argFlag=!0:t.args={},"count"in t?(t.count=parseInt(t.count),(!Number.isInteger(t.count)||t.count<=0)&&(t.count=20)):t.count=20,n+="&count="+t.count,"next_max_like_id"in t&&(n+="&next_max_like_id="+t.next_max_like_id)),jQuery.ajax({type:"POST",dataType:"jsonp",url:n,success:function(e){o&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(i&&(e=i(e,s.filterArguments,t.args)),window[t.success[0]][t.success[1]](e)):"string"==typeof t.success?"function"==typeof window[t.success]&&(i&&(e=i(e,s.filterArguments,t.args)),window[t.success](e)):"function"==typeof t.success&&(i&&(e=i(e,s.filterArguments,t.args)),t.success(e)))},error:function(e){r&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:e})},this.getUserRecentMedia=function(e,t){var s=this,o=!1,r=this.statusCode,i=!1,n=this.getFilter("getUserRecentMedia"),e="https://api.instagram.com/v1/users/"+e+"/media/recent/?access_token="+u();void 0===t||0===t.length||("success"in t&&(o=!0),"statusCode"in t&&(r=t.statusCode),"args"in t||(t.args={}),"error"in t&&(i=!0),"count"in t?(t.count=parseInt(t.count),(!Number.isInteger(t.count)||t.count<=0)&&(t.count=33)):t.count=33,e+="&count="+t.count,"min_id"in t&&(e+="&min_id="+t.min_id),"max_id"in t&&(e+="&max_id="+t.max_id)),jQuery.ajax({type:"POST",dataType:"jsonp",url:e,success:function(e){void 0===e.data&&(e.data=[]),o&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(n&&(e=n(e,s.filterArguments,t.args)),window[t.success[0]][t.success[1]](e)):"string"==typeof t.success?"function"==typeof window[t.success]&&(n&&(e=n(e,s.filterArguments,t.args)),window[t.success](e)):"function"==typeof t.success&&(n&&(e=n(e,s.filterArguments,t.args)),t.success(e)))},error:function(e){i&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:r})},this.getUserMedia=function(o,r,i){r=void 0===r?"":r,i=void 0===i||"number"!=typeof i?0:i;var n=this,c=!1,e=this.statusCode,t=!1,a=this.getFilter("getUserMedia");void 0===o||0===o.length||("success"in o&&(c=!0),"error"in o&&(t=!0),"statusCode"in o&&(e=o.statusCode),"args"in o||(o.args={}),"count"in o?(o.count=parseInt(o.count),(!Number.isInteger(o.count)||o.count<=0)&&(o.count=20)):o.count=20),jQuery.ajax({type:"POST",url:wdi_ajax.ajax_url,dataType:"json",data:{wdi_nonce:wdi_ajax.wdi_nonce,action:"wdi_getUserMedia",user_name:g(),feed_id:wdi_ajax.feed_id,next_url:r,iter:i},success:function(e){var t=!1,s="";if(void 0!==e.error&&(t=!0,s=e.error.type),void 0!==e.error&&"OAuthException"!==e.error.type&&l<5)return l++,void w.getUserMedia(o,r,e.iter);void 0!==e.iter&&p.data.length<parseInt(wdi_ajax.number_of_photos)&&i<20&&""!=e.pagination.next_url?(r=e.pagination.next_url,p.data=p.data.concat(e.data),p.pagination=e.pagination,w.getUserMedia(o,r,e.iter)):(0!=p.data.length&&(e=p),e.meta={code:200,error:t,error_type:s},c&&("object"==typeof o.success&&2==o.success.length?void 0!==window[o.success[0]]&&"function"==typeof window[o.success[0]][o.success[1]]&&(a&&(e=w.addTags(e),e=a(e,n.filterArguments,o)),window[o.success[0]][o.success[1]](e)):"string"==typeof o.success?"function"==typeof window[o.success]&&(a&&(e=w.addTags(e),e=a(e,n.filterArguments,o)),window[o.success](e)):"function"==typeof o.success&&o.success(e)))},error:function(e){t&&("object"==typeof o.error&&2==o.error.length?"function"==typeof window[o.error[0]][o.error[1]]&&window[o.error[0]][o.error[1]](e):"string"==typeof o.error?"function"==typeof window[o.error]&&window[o.error](e):"function"==typeof o.error&&o.error(e))},statusCode:e})},this.getUserInfo=function(e,t){var s=this,o=!1,r=this.statusCode,i=!1,n=this.getFilter("getUserInfo");void 0===t||0===t.length||("success"in t&&(o=!0),"error"in t&&(i=!0),"statusCode"in t&&(r=t.statusCode)),jQuery.ajax({type:"POST",dataType:"jsonp",url:"https://api.instagram.com/v1/users/"+e+"/?access_token="+u(),success:function(e){o&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(n&&(e=n(e,s.filterArguments)),window[t.success[0]][t.success[1]](e)):"string"==typeof t.success?"function"==typeof window[t.success]&&(n&&(e=n(e,s.filterArguments)),window[t.success](e)):"function"==typeof t.success&&(n&&(e=n(e,s.filterArguments)),t.success(e)))},error:function(e){i&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:r})},this.getSelfInfo=function(s){var o=this,r=!1,i=this.statusCode,n=!1,c=this.getFilter("getSelfInfo");void 0===s||0===s.length||("success"in s&&(r=!0),"error"in s&&(n=!0),"statusCode"in s&&(i=s.statusCode));var a="https://graph.facebook.com/v3.2/"+(void 0!==w.user&&void 0!==w.user.user_id?w.user.user_id:"undefined"!=typeof wdi_object&&void 0!==wdi_object.user?wdi_object.user.user_id:"")+"?fields=id,ig_id,username,name,biography,profile_picture_url,followers_count,follows_count,media_count,website&access_token="+u();w.getDataFromCache(function(e){var t;!1===e?jQuery.ajax({type:"POST",dataType:"jsonp",url:a,statusCode:i,success:function(e){w.setDataToCache(a,e),r&&("object"==typeof s.success&&2==s.success.length?void 0!==window[s.success[0]]&&"function"==typeof window[s.success[0]][s.success[1]]&&(c&&(e.meta={code:200},e=c(e,o.filterArguments)),window[s.success[0]][s.success[1]](e)):"string"==typeof s.success?"function"==typeof window[s.success]&&(c&&(e.meta={code:200},e=c(e,o.filterArguments)),window[s.success](e)):"function"==typeof s.success&&(c&&(e.meta={code:200},e=c(e,o.filterArguments)),s.success(e)))},error:function(e){n&&("object"==typeof s.error&&2==s.error.length?"function"==typeof window[s.error[0]][s.error[1]]&&window[s.error[0]][s.error[1]](e):"string"==typeof s.error?"function"==typeof window[s.error]&&window[s.error](e):"function"==typeof s.error&&s.error(e))}}):(t=e,r&&("object"==typeof s.success&&2==s.success.length?void 0!==window[s.success[0]]&&"function"==typeof window[s.success[0]][s.success[1]]&&(c&&(t=c(t,o.filterArguments)),window[s.success[0]][s.success[1]](t)):"string"==typeof s.success?"function"==typeof window[s.success]&&(c&&(t=c(t,o.filterArguments)),window[s.success](t)):"function"==typeof s.success&&(c&&(t=c(t,o.filterArguments)),s.success(t))))},a)},this.getRecentMediaComments=function(e,t,s){var o=this,r=!1,i=this.statusCode,n=!1,c=this.getFilter("getRecentMediaComments");void 0===t||0===t.length||("success"in t&&(r=!0),"error"in t&&(n=!0),"statusCode"in t&&(i=t.statusCode)),jQuery(".wdi_comment_container #ajax_loading #opacity_div").css("display","block"),jQuery(".wdi_comment_container #ajax_loading #loading_div").css("display","block"),jQuery.ajax({type:"POST",url:wdi_ajax.ajax_url,dataType:"json",data:{wdi_nonce:wdi_ajax.wdi_nonce,action:"wdi_getRecentMediaComments",user_name:g(),media_id:e,next:s},success:function(e){e=e,r&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(c&&(e=c(e,o.filterArguments)),window[t.success[0]][t.success[1]](e)):"string"==typeof t.success?"function"==typeof window[t.success]&&(c&&(e=c(e,o.filterArguments)),window[t.success](e)):"function"==typeof t.success&&(c&&(e=c(e,o.filterArguments)),t.success(e)))},complete:function(){jQuery(".wdi_comment_container #ajax_loading #opacity_div").css("display","none"),jQuery(".wdi_comment_container #ajax_loading #loading_div").css("display","none")},error:function(e){n&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:i})},this.getRecentMediaLikes=function(e,t){var s=this,o=!1,r=this.statusCode,i=!1,n=this.getFilter("getRecentMediaLikes");void 0===t||0===t.length||("success"in t&&(o=!0),"error"in t&&(i=!0),"statusCode"in t&&(r=t.statusCode)),jQuery.ajax({type:"POST",dataType:"jsonp",url:"https://api.instagram.com/v1/media/"+e+"/likes?access_token="+u(),success:function(e){o&&("object"==typeof t.success&&2==t.success.length?void 0!==window[t.success[0]]&&"function"==typeof window[t.success[0]][t.success[1]]&&(n&&(e=n(e,s.filterArguments)),window[t.success[0]][t.success[1]](e)):"string"==typeof t.success?"function"==typeof window[t.success]&&(n&&(e=n(e,s.filterArguments)),window[t.success](e)):"function"==typeof t.success&&(n&&(e=n(e,s.filterArguments)),t.success(e)))},error:function(e){i&&("object"==typeof t.error&&2==t.error.length?"function"==typeof window[t.error[0]][t.error[1]]&&window[t.error[0]][t.error[1]](e):"string"==typeof t.error?"function"==typeof window[t.error]&&window[t.error](e):"function"==typeof t.error&&t.error(e))},statusCode:r})},this.getDataFromCache=function(t,e,s){void 0===s&&(s=!0),jQuery.ajax({type:"POST",async:s,url:wdi_ajax.ajax_url,dataType:"json",data:{wdi_cache_name:e,wdi_nonce:wdi_ajax.wdi_nonce,WDI_MINIFY:wdi_ajax.WDI_MINIFY,task:"get",action:"wdi_cache"},success:function(e){e.success&&void 0!==e.cache_data&&null!==e.cache_data?(e=JSON.parse(e.cache_data),t(e)):t(!1)}})},this.setDataToCache=function(e,t){jQuery.ajax({type:"POST",url:wdi_ajax.ajax_url,dataType:"json",data:{wdi_cache_name:e,wdi_cache_response:JSON.stringify(t),wdi_nonce:wdi_ajax.wdi_nonce,task:"set",action:"wdi_cache"},success:function(e){}})}}